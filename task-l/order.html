<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    #map {
      height: 400px;
    }
  </style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#1c1917',   //stone-900
            secondary: '#F9FAFb', //gray-50
            tertiary: '#e5e7eb',  //gray-200
            accent: '#57534e',    //stone-600
            background: '#FFFFFF',
            text: '#030712',      //gray-950
            footertext: "#a8a29e" //stone-400
          },
        },
      },
    };
  </script>
  <title>Cross Cars - Catalog</title>
</head>

<body class="flex flex-col min-h-screen text-text text-lg">
  <header class="bg-primary text-white">
    <div class="max-w-screen-lg mx-auto flex items-center justify-between p-2">
      <div class="flex items-center gap-2">
        <img src="../global_resources/CrossCarsLogo.png" alt="Cross Cars Logo" class="h-20 w-auto">
      </div>
      <nav class="flex items-center gap-8">
        <a href="index.html" class="hover:text-blue-400">Home</a>
        <a href="catalog.html" class="hover:text-blue-400">Catalog</a>
        <a href="order.html" class="hover:text-blue-400">Rent</a>
        <button class="bg-slate-100 text-blue-600 px-4 py-2 rounded hover:bg-blue-100">Download</button>
      </nav>
  </header>

  <div class="flex flex-grow flex-col md:flex-row max-w-screen-lg mx-auto">
    <main class="flex-grow text-center">

      <h3 class="py-4 bg-secondary text-2xl font-bold text-center">Rent fast with conveniently</h3>
      <section class="px-6 bg-secondary flex-grow grid md:grid-cols-[2fr_1fr] gap-x-20">
        <div>
          <p class="p-1 text-justify">
            Welcome to our rent page. Select the item you wish to reserve and choose your times.
          </p>
          <p class="p-1 text-justify">Remember to refuel your vehicule during long-time rents, as you will be
            charged for an extra of 60â‚¬ if the vehicule is returned below 10% fuel. Fill up the fuel will reduce your
            overall
            charge.</p>
          <p class="p-1 text-justify mb-5">We will never communicate your personnal data.</p>
        </div>
        <div class="flex items-center justify-center">
          <div class="bg-primary p-4 rounded-lg mt-4 md:mt-0">
            <img src="../global_resources/CrossCarsLogo.png" alt="Cross Cars Logo"
              class="h-40 w-auto md:h-auto md:w-auto">
          </div>
        </div>
      </section>

      <form id="addInfoForm" novalidate class="bg-secondary p-6">

        <h4 class="text-xl font-bold mb-4 text-primary mt-6">Reservation details</h4>

        <div class="grid md:grid-cols-2 gap-8">

          <!-- LEFT COLUMN -->
          <div>

            <!-- Full Name -->
            <label for="fullName" class="block font-medium text-primary mb-1">Full name</label>
            <input id="fullName" name="fullName" type="text" required
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="name-error" class="text-red-500 text-sm"></span>
            <script>
              const nameInput = document.getElementById("fullName");
              const nameError = document.getElementById('name-error');
              function validateName(submit) {
                const value = nameInput.value.trim(); // remove spaces at start/end
                const namePattern = /^[A-Za-z\s]+$/; // only letters and spaces

                if (value === '') {
                  if (submit === 1) nameError.textContent = 'Name is required.';
                } else if (!namePattern.test(value)) {
                  nameError.textContent = 'Name can only contain letters and spaces.';
                } else if (value.length < 2) {
                  nameError.textContent = 'Name must be at least 2 characters.';
                } else {
                  nameError.textContent = ''; // clear error
                }
              }
              nameInput.addEventListener('blur', () => validateName(0));
            </script>

            <!-- Email -->
            <label for="email" class="block mt-4 font-medium text-primary mb-1">Email</label>
            <input id="email" name="email" type="email" required placeholder="example@email.com"
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="email-error" class="text-red-500 text-sm"></span>

            <!-- Phone -->
            <label for="tel" class="block mt-4 font-medium text-primary mb-1">Phone</label>
            <input id="tel" name="tel" type="tel" placeholder="06 12 34 56 78"
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="phone-error" class="text-red-500 text-sm"></span>

            <!-- DoB -->
            <label for="dob" class="block mt-4 font-medium text-primary mb-1">Date of birth</label>
            <input id="dob" name="DoB" type="date" required
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="dob-error" class="text-red-500 text-sm"></span>
          </div>

          <!-- RIGHT COLUMN -->
          <div>

            <!-- Item -->
            <label for="item" class="block font-medium text-primary mb-1">Item</label>
            <select id="item" name="item" required
              class="w-full p-2 rounded border border-tertiary bg-white focus:ring-2 focus:ring-accent focus:outline-none">
              <option value="eco-001">ECO-001</option>
              <option value="eco-002">ECO-002</option>
              <option value="eco-003">ECO-003</option>
              <option value="eco-004">ECO-004</option>
              <option value="eco-005">ECO-005</option>
              <option value="suv-001">SUV-001</option>
              <option value="suv-002">SUV-002</option>
              <option value="suv-003">SUV-003</option>
              <option value="suv-004">SUV-004</option>
              <option value="lux-001">LUX-001</option>
              <option value="lux-002">LUX-002</option>
            </select>
            <span id="item-error" class="text-red-500 text-sm"></span>

            <script>
              document.addEventListener('DOMContentLoaded', function () {
                const params = new URLSearchParams(window.location.search);
                const requestedItem = params.get('item');

                if (!requestedItem) return;

                const select = document.getElementById('item');
                const errorEl = document.getElementById('item-error');

                const hasMatch = Array.from(select.options).some(opt => opt.value === requestedItem);

                if (hasMatch) {
                  select.value = requestedItem;
                  if (errorEl) errorEl.textContent = '';
                } else {
                  if (errorEl) {
                    errorEl.textContent = `Item unknow: ${requestedItem}`;
                  }
                }
              });
            </script>

            <!-- Start Date -->
            <label for="dos" class="block mt-4 font-medium text-primary mb-1">Date of Start</label>
            <input id="dos" name="dos" type="date" required
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="dos-error" class="text-red-500 text-sm"></span>

            <!-- End Date -->
            <label for="doe" class="block mt-4 font-medium text-primary mb-1">Date of End</label>
            <input id="doe" name="doe" type="date" required
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none">
            <span id="doe-error" class="text-red-500 text-sm"></span>

            <!-- Additional info -->
            <label for="plus" class="block mt-4 font-medium text-primary mb-1">Additional infos</label>
            <textarea id="plus" name="plus"
              class="w-full p-2 rounded border border-tertiary focus:ring-2 focus:ring-accent focus:outline-none h-24"></textarea>
          </div>
        </div>

        <!-- CHECKBOXES -->
        <div class="mt-6 space-y-3">
          <label class="flex items-center gap-2 text-primary">
            <input id="terms" name="terms" type="checkbox" required class="h-4 w-4">
            I accept terms and conditions
          </label>

          <label class="flex items-center gap-2 text-primary">
            <input id="subscribe" name="subscribe" type="checkbox" class="h-4 w-4">
            Subscribe to newsletter
          </label>
        </div>

        <!-- BUTTONS -->
        <div class="mt-6 flex gap-4">
          <button id="addRowBtn" type="submit"
            class="btn bg-primary text-white px-6 py-2 rounded transition disabled:opacity-50 disabled:cursor-not-allowed">
            Proceed to payment
          </button>

          <button id="reset" type="reset"
            class="px-6 py-2 rounded border border-primary text-primary hover:bg-tertiary transition">Clear</button>
        </div>

      </form>
    </main>
  </div>

  <footer class="bg-primary p-4 relative">
    <div class="md:flex md:items-center md:justify-between mb-2 mt-2 md:mb-0 md:mt-0">
      <div class="flex space-x-4 justify-center mt-2 md:mt-0"> <!-- Icon exclusive -->
        <a href="//github.com/Ozenos/">
          <svg class="fill-current text-footertext" aria-hidden="true" focusable="false" viewBox="0 0 16 16" width="24"
            height="24">
            <path
              d="M14.667 0H1.333C.597 0 0 .597 0 1.333v13.334C0 15.403.597 16 1.333 16h7.334v-6h-2V7.333h2V5.61c0-2.067 1.262-3.192 3.106-3.192.883 0 1.642.066 1.863.095v2.16h-1.279c-1.002 0-1.196.477-1.196 1.176v1.485h2.96L13.454 10h-2.293v6h3.506c.736 0 1.333-.597 1.333-1.333V1.333C16 .597 15.403 0 14.667 0z">
            </path>
          </svg></a>
        <a href="//github.com/Ozenos/">
          <svg class="fill-current text-footertext" aria-hidden="true" focusable="false" viewBox="0 0 14 12" width="24"
            height="24">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M13.973 1.429a5.556 5.556 0 01-1.649.476A3.02 3.02 0 0013.587.231c-.554.34-1.169.59-1.823.728A2.792 2.792 0 009.668 0c-1.585 0-2.87 1.356-2.87 3.025 0 .24.026.47.074.692-2.385-.12-4.5-1.328-5.916-3.154-.249.443-.388.96-.388 1.522 0 1.051.507 1.976 1.276 2.52a2.754 2.754 0 01-1.3-.378v.036c0 1.467.988 2.692 2.302 2.97a2.776 2.776 0 01-1.29.052c.368 1.202 1.426 2.077 2.685 2.102A5.566 5.566 0 010 10.641 7.856 7.856 0 004.407 12c5.282 0 8.168-4.611 8.168-8.604 0-.13 0-.259-.01-.388.56-.424 1.05-.959 1.435-1.567l-.027-.012z">
            </path>
          </svg></a>
        <a href="//github.com/Ozenos/">
          <svg class="fill-current text-footertext" aria-hidden="true" focusable="false" viewBox="0 0 16 16" width="24"
            height="24">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M8 0C5.827 0 5.555.01 4.702.048 3.85.088 3.27.222 2.76.42a3.908 3.908 0 00-1.417.923c-.445.444-.72.89-.923 1.417-.198.51-.333 1.09-.372 1.942C.008 5.555 0 5.827 0 8s.01 2.445.048 3.298c.04.852.174 1.433.372 1.942.204.526.478.973.923 1.417.444.445.89.72 1.417.923.51.198 1.09.333 1.942.372.853.04 1.125.048 3.298.048s2.445-.01 3.298-.048c.852-.04 1.433-.174 1.942-.372a3.908 3.908 0 001.417-.923c.445-.444.72-.89.923-1.417.198-.51.333-1.09.372-1.942.04-.853.048-1.125.048-3.298s-.01-2.445-.048-3.298c-.04-.852-.174-1.433-.372-1.942a3.908 3.908 0 00-.923-1.417A3.886 3.886 0 0013.24.42c-.51-.198-1.09-.333-1.942-.372C10.445.008 10.173 0 8 0zm0 1.44c2.136 0 2.39.01 3.233.048.78.036 1.203.166 1.485.276.374.145.64.318.92.598.28.28.453.546.598.92.11.282.24.705.276 1.485.038.844.047 1.097.047 3.233s-.01 2.39-.05 3.233c-.04.78-.17 1.203-.28 1.485-.15.374-.32.64-.6.92-.28.28-.55.453-.92.598-.28.11-.71.24-1.49.276-.85.038-1.1.047-3.24.047s-2.39-.01-3.24-.05c-.78-.04-1.21-.17-1.49-.28a2.49 2.49 0 01-.92-.6c-.28-.28-.46-.55-.6-.92-.11-.28-.24-.71-.28-1.49-.03-.84-.04-1.1-.04-3.23s.01-2.39.04-3.24c.04-.78.17-1.21.28-1.49.14-.38.32-.64.6-.92.28-.28.54-.46.92-.6.28-.11.7-.24 1.48-.28.85-.03 1.1-.04 3.24-.04L8 1.44zm0 2.452a4.108 4.108 0 100 8.215 4.108 4.108 0 000-8.215zm0 6.775a2.667 2.667 0 110-5.334 2.667 2.667 0 010 5.334zm5.23-6.937a.96.96 0 11-1.92 0 .96.96 0 011.92 0z">
            </path>
          </svg></a>
      </div>
      <p
        class="text-footertext text-xs text-center mt-2 md:mt-0 md:absolute md:left-1/2 md:transform md:-translate-x-1/2">
        Tel: +33 7 89 01 23 - Email: communication@crosscars.com</p>
      <p class="text-footertext text-xs md:text-right text-center mt-2">Copyright Â© 2025 Cross Cars PLC Â· Trademark
        Policy</p>
    </div>
  </footer>
  <script>
    document.addEventListener("DOMContentLoaded", function () {

      // ðŸ”— RÃ©cupÃ©ration des inputs
      const fullName = document.getElementById("fullName");
      const email = document.getElementById("email");
      const tel = document.getElementById("tel");
      const dob = document.getElementById("dob");
      const item = document.getElementById("item");
      const dos = document.getElementById("dos");
      const doe = document.getElementById("doe");
      const terms = document.getElementById("terms");
      const form = document.getElementById("addInfoForm");

      // ðŸ”— RÃ©cupÃ©ration des Ã©lÃ©ments d'erreur
      const errors = {
        fullName: document.getElementById("name-error"),
        email: document.getElementById("email-error"),
        tel: document.getElementById("phone-error"),
        dob: document.getElementById("dob-error"),
        item: document.getElementById("item-error"),
        dos: document.getElementById("dos-error"),
        doe: document.getElementById("doe-error")
      };

      // ðŸ”˜ Bouton submit
      const submitBtn = document.getElementById("addRowBtn");

      // --- Ã©tat local pour Ã©viter d'afficher les erreurs tout de suite ---
      const touched = {
        fullName: false,
        email: false,
        tel: false,
        dob: false,
        item: false,
        dos: false,
        doe: false
      };
      let submitAttempted = false;

      // --- fonctions de validation : retournent une string ('' = ok) ---
      function getFullNameError() {
        const v = fullName.value.trim();
        const pattern = /^[A-Za-zÃ€-Ã–Ã˜-Ã¶Ã¸-Ã¿\s\-']+$/;
        if (v === "") return "Name is required.";
        if (!pattern.test(v)) return "Invalid characters in name.";
        if (v.length < 2) return "Name must be at least 2 characters.";
        return "";
      }

      function getEmailError() {
        const v = email.value.trim();
        const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (v === "") return "Email is required.";
        if (!pattern.test(v)) return "Invalid email format.";
        return "";
      }

      function getPhoneError() {
        const v = tel.value.trim();
        if (v === "") return ""; // phone optional in your earlier logic
        const pattern = /^[0-9\+\-\s]{6,20}$/;
        if (!pattern.test(v)) return "Invalid phone number.";
        return "";
      }

      function getDobError() {
        if (dob.value === "") return "Date of birth required.";
        return "";
      }

      function getItemError() {
        // if you want a placeholder, ensure select has <option value="">Chooseâ€¦</option>
        if (item.value === "") return "Please select an item.";
        return "";
      }

      function getStartError() {
        if (dos.value === "") return "Start date required.";
        return "";
      }

      function getEndError() {
        if (doe.value === "") return "End date required.";
        if (dos.value && doe.value < dos.value) return "End date must be after start date.";
        return "";
      }

      // --- mise Ã  jour visuelle d'un champ donnÃ© (affiche le message seulement si touched || submitAttempted) ---
      function updateFieldMessage(fieldName, msg) {
        const el = errors[fieldName];
        if (!el) return;
        if (touched[fieldName] || submitAttempted) {
          el.textContent = msg;
        } else {
          el.textContent = "";
        }

        // Optionnel : ajouter / retirer style d'erreur sur l'input
        const inputMap = {
          fullName, email, tel, dob, item, dos, doe
        };
        const inputEl = inputMap[fieldName];
        if (inputEl) {
          if (msg) {
            inputEl.classList.add("ring-2", "ring-red-500");
          } else {
            inputEl.classList.remove("ring-2", "ring-red-500");
          }
        }
      }

      // --- calcule toutes les erreurs (sans les afficher si pas touched) ---
      function computeAllErrors() {
        return {
          fullName: getFullNameError(),
          email: getEmailError(),
          tel: getPhoneError(),
          dob: getDobError(),
          item: getItemError(),
          dos: getStartError(),
          doe: getEndError()
        };
      }

      // --- met Ã  jour l'affichage pour tous les champs (affiche seulement touched/submitAttempted) ---
      function refreshAllMessages() {
        const all = computeAllErrors();
        for (const key in all) {
          updateFieldMessage(key, all[key]);
        }
      }

      // --- active/dÃ©sactive le bouton submit en fonction des erreurs et checkbox terms ---
      function updateSubmitButton() {
        const all = computeAllErrors();
        const hasErrors = Object.values(all).some(msg => msg !== "");
        const mustAcceptTerms = !terms.checked;
        submitBtn.disabled = hasErrors || mustAcceptTerms;
        submitBtn.classList.toggle("opacity-50", submitBtn.disabled);
        submitBtn.classList.toggle("cursor-not-allowed", submitBtn.disabled);
      }

      // --- handlers pour input / blur ---
      fullName.addEventListener("input", () => {
        // live update but only show message if touched or submitAttempted
        updateFieldMessage("fullName", getFullNameError());
        updateSubmitButton();
      });
      email.addEventListener("input", () => { updateFieldMessage("email", getEmailError()); updateSubmitButton(); });
      tel.addEventListener("input", () => { updateFieldMessage("tel", getPhoneError()); updateSubmitButton(); });
      dob.addEventListener("change", () => { updateFieldMessage("dob", getDobError()); updateSubmitButton(); });
      item.addEventListener("change", () => { updateFieldMessage("item", getItemError()); updateSubmitButton(); });
      dos.addEventListener("change", () => { updateFieldMessage("dos", getStartError()); updateSubmitButton(); });
      doe.addEventListener("change", () => { updateFieldMessage("doe", getEndError()); updateSubmitButton(); });

      // show errors after the user leaves the field (blur)
      fullName.addEventListener("blur", () => { touched.fullName = true; updateFieldMessage("fullName", getFullNameError()); updateSubmitButton(); });
      email.addEventListener("blur", () => { touched.email = true; updateFieldMessage("email", getEmailError()); updateSubmitButton(); });
      tel.addEventListener("blur", () => { touched.tel = true; updateFieldMessage("tel", getPhoneError()); updateSubmitButton(); });
      dob.addEventListener("blur", () => { touched.dob = true; updateFieldMessage("dob", getDobError()); updateSubmitButton(); });
      item.addEventListener("blur", () => { touched.item = true; updateFieldMessage("item", getItemError()); updateSubmitButton(); });
      dos.addEventListener("blur", () => { touched.dos = true; updateFieldMessage("dos", getStartError()); updateSubmitButton(); });
      doe.addEventListener("blur", () => { touched.doe = true; updateFieldMessage("doe", getEndError()); updateSubmitButton(); });

      // --- Submit : tenter d'envoyer, afficher toutes les erreurs si besoin et bloquer l'envoi ---
      form.addEventListener("submit", function (e) {
        submitAttempted = true;

        // marquer tous les champs comme "touchÃ©s" pour afficher les messages
        for (const k in touched) touched[k] = true;

        refreshAllMessages();
        updateSubmitButton();

        if (submitBtn.disabled) {
          e.preventDefault();
          // facultatif : focus sur le premier champ en erreur
          const firstErrorKey = Object.keys(computeAllErrors()).find(k => computeAllErrors()[k] !== "");
          if (firstErrorKey) {
            const map = { fullName, email, tel, dob, item, dos, doe };
            map[firstErrorKey].focus();
          }
        }
        // sinon le formulaire peut soumettre normalement
      });

      // --- Initialisation : ne pas afficher d'erreurs immÃ©diatement, mais calculer l'Ã©tat du bouton ---
      updateSubmitButton();
    });
  </script>

</body>

</html>